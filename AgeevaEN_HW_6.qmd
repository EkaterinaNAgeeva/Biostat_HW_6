---
title: "HW_6"
author: "AgeevaEN"
format: html
editor: visual
---
**Задание 1**
Рассчитайте выборку для исследования терапевтической эквивалентности для двухпериодного cross-over дизайна. Из предыдущих исследований известно, что дисперсия составляет 20%, а разница средних составляет −10%. Клиницисты сообщают нам, что клинически значимая разница составляет 25%.

```{r}
# Установка уровня значимости
Z <- 0.05

# Установка дисперсии
E <- 0.20

# Установка клинически значимой разницы
C <- 0.25

# Установка ожидаемого drop-out rate
DR <- 0.10

# Установка доли участников в исследовании
P <- 0.80

# Установка доли участников, которые должны выйти из исследования
Q <- DR

# Рассчет размера выборки
n <- (((Z * sqrt(1 - Z^2))^2 * E^2) / ((C/100)^2)) * (1 - DR) * (1 - (1 - P)) / (P * (1 - Q))

# Форматирование числа с заданным количеством цифр после запятой
n_formatted <- round(n, 0)

print(paste("Размер общей выборки:", n_formatted))
```
Размер общей вфборки 16. Значит каждой по отдельности, при условии, что они равны- 8


**Задание 2**
 Рассчитайте выборку для гипотезы non-inferiority для двухвыборочного параллельного дизайна. Пусть клинически значимая разница  = -0.1, то есть мы ожидаем разницу не меньше 10%, а долю ответов для тестового препарата  = 0.65, в то время как нам известно из предыдущих исследований, что доля ответов у препарата сравнения составляет  = 0.85. Соотношение групп равно  = 1.

```{r}
# Уровень значимости для альтернативной гипотезы
Z_alpha_2 <- 1.96

# Уровень значимости для базовой гипотезы
Z_beta <- 1.96

# Доля ответов для тестового препарата в группе сравнения
p1 <- 0.85

# Доля ответов для тестового препарата в группе для проверки альтернативной гипотезы
p2 <- 0.65

# Клинически значимая разница
delta <- -0.1

# Соотношение групп
k <- 1

# Рассчет размера выборки
n <- (((Z_alpha_2 + Z_beta)^2) * (p1 * (1 - p1) + p2 * (1 - p2)) / (p1 - p2 - delta)^2) * k


print(paste("Размер выборки:", round(n)))
```
Размер общей выборки 61
Каждой из выборок 30
```{r}
# С учетом drop-out rate)
# Уровень значимости для альтернативной гипотезы
Z_alpha_2 <- 1.96

# Уровень значимости для базовой гипотезы
Z_beta <- 1.96

# Доля ответов для тестового препарата в группе сравнения
p1 <- 0.85

# Доля ответов для тестового препарата в группе для проверки альтернативной гипотезы
p2 <- 0.65

# Клинически значимая разница
delta <- -0.1

# Доля участников, которые выбыли из исследования или не смогли завершить его
dropout_rate <- 0.1

# Соотношение групп
k <- 1

# Рассчет размера выборки
n <- ((((Z_alpha_2 + Z_beta)^2) * (p1 * (1 - p1) + p2 * (1 - p2))) / ((p1 - p2 - delta)^2 * (1 - dropout_rate)^2)) * k

# Форматирование числа с заданным количеством цифр после запятой
n_formatted <- round(n, 0)

print(paste("Размер выборки:", n_formatted))
```
С учетом drop-out rate:
Общая 75.
каждая по 35
